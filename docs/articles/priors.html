<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Developing informative priors • WILD6900</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Developing informative priors">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">WILD6900</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2019.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/syllabus.html">
    <span class="fas fa fas fa-book"></span>
     
    Syllabus
  </a>
</li>
<li>
  <a href="../articles/schedule.html">
    <span class="fas fa fas fa-calendar"></span>
     
    Schedule
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-file-pdf-o"></span>
     
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Lecture0/Lecture0.html">Lecture 0: Introduction to WILD6900</a>
    </li>
    <li>
      <a href="../articles/Lecture1/Lecture1.html">Lecture 1: Introduction to statistical inference in ecology</a>
    </li>
    <li>
      <a href="../articles/Lecture2/Lecture2.html">Lecture 2: Probability refresher (or introduction)</a>
    </li>
    <li>
      <a href="../articles/Lecture3/Lecture3.html">Lecture 3: Principles of Bayesian inference</a>
    </li>
    <li>
      <a href="../articles/Lecture4/Lecture4.html">Lecture 4: More about prior distributions</a>
    </li>
    <li>
      <a href="../articles/Lecture5/Lecture5.html">Lecture 5: Implementing Bayesian models: Introduction to MCMC samplers</a>
    </li>
    <li>
      <a href="../articles/Lecture6/Lecture6.html">Lecture 6: Introduction of Bayesian analysis using JAGS</a>
    </li>
    <li>
      <a href="../articles/Lecture7/Lecture7.html">Lecture 7: Generalized linear model review</a>
    </li>
    <li>
      <a href="../articles/Lecture8/Lecture8.html">Lecture 8: Introduction to hierarchical models</a>
    </li>
    <li>
      <a href="../articles/Lecture9/Lecture9.html">Lecture 9: Introduction to state-space models</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-desktop"></span>
     
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/projects_and_directories.html">Projects and directories</a>
    </li>
    <li>
      <a href="../articles/rmarkdown_intro.html">Introduction to R Markdown</a>
    </li>
    <li>
      <a href="../articles/priors.html">Creating prior distributions</a>
    </li>
    <li>
      <a href="../articles/simulation.html">Simulating regression data</a>
    </li>
    <li>
      <a href="../articles/metropolis.html">Metropolis sampler for linear regression model</a>
    </li>
    <li>
      <a href="../articles/poisson_glm.html">Poisson and binomial GLMs in JAGS</a>
    </li>
    <li>
      <a href="../articles/random_effects.html">Random effects ANCOVA in JAGS</a>
    </li>
    <li>
      <a href="../articles/state_space.html">Simple state-space models in JAGS</a>
    </li>
    <li>
      <a href="../articles/state_space2.html">Age-structured state-space models</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/homework.html">
    <span class="fas fa fas fa-pencil-square-o"></span>
     
    Assignments
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Developing informative priors</h1>
            <h3 class="subtitle">WILD6900</h3>
            
            <h4 class="date">2019-03-04</h4>
      
      
      <div class="hidden name"><code>priors.Rmd</code></div>

    </div>

    
    
<p>Given the practical and philosophical advantages of informative priors, why aren’t they more common in ecological models? As already discussed, one issue is cultural - many researchers are simply uncomfortable with the <em>idea</em> of informative priors. <em>“If we can choose any prior we want and that choice influences our inferences, doesn’t that make the entire process too subjective?” “Shouldn’t we let the data speak for itself?”</em> If one of these scientists is your adviser or the reviewer of your manuscript, you may be forced to use uninformative priors.</p>
<p>But another obstacle to using informative priors is that they can be hard to formulate. How do we translate our domain expertise into a probability distribution? How do we take a published estimate(s) of the parameter value and turn it (or them) into a probability distribution? The skills needed to translate prior knowledge into informative priors are not generally taught in the statistics classes taken by most ecologists.</p>
<p>In this activity, we’ll work through a few examples of ways to create informative priors from a variety of types of information.</p>
<div id="question-and-model-development" class="section level2">
<h2 class="hasAnchor">
<a href="#question-and-model-development" class="anchor"></a>Question and model development</h2>
<p>One issue in many ecological studies is that it is logistically and financially difficult to collect data from a large number of individuals. As a result, vital rate estimates are often based on relatively small sample sizes, which can lead to high uncertainty and possibly spurious results.</p>
<p>It is precisely in these instances where Bayesian methods can shine - as we saw in lecture, the ability to incorporate previous knowledge of parameter values via informative priors is equivalent to increasing your sample size.</p>
<p>To explore different ways of generating informative priors, we will borrow data and some clever ideas from a recently published paper on the dynamics of Polar Bear (<em>Ursus maritimus</em>) populations in the Chukchi Sea (Regehr et al. 2018). For this example, we will focus on a subset of the full model, namely estimating annual survival of adult female bears.</p>
<p>In the model developed by Regehr et al. (2018), female survival was identifiable but estimates were imprecise using only the available data due to small sample sizes. As a result, the authors chose to develop informative priors based on published survival estimates from other populations. In this case, the authors were fortunate to have a handful of previous studies to lean-on and later in this exercise we will learn how they developed priors from those studies. But first, let’s assume there are no published studies but we still want the benefits of informative priors.</p>
</div>
<div id="example-1-domain-expertise" class="section level2">
<h2 class="hasAnchor">
<a href="#example-1-domain-expertise" class="anchor"></a>Example 1: Domain expertise</h2>
<p>Even if we have no previous estimates of polar bear survival, we are not completely ignorant about survival of this species. We can use our <em>domain expertise</em> to develop a prior that improves upon the non-informative option.</p>
<p>Polar bears are a large, long-lived carnivore with a life expectancy of about 20-25 years (Ramsay &amp; Stirling 1988). This simple fact suggests that adult survival must be pretty high - even with an annual survival probability of <span class="math inline">\(95\%\)</span>, an individual would only have a 36% probability of surviving 20 years. So survival probabilities much less than <span class="math inline">\(\sim 90\%\)</span> would be pretty surprising and we would be pretty suspicious of estimates less than <span class="math inline">\(\sim 80\%\)</span> (which would imply <span class="math inline">\(1\%\)</span> of female polar bears make it to 20 years of age).</p>
<p>Of course, polar bear populations in many areas are declining pretty quickly, suggesting that maybe adult survival rates could be lower than historical levels. So although we can be pretty that survival is high (e.g., <span class="math inline">\(&gt;80\%\)</span>), we’re not super confident about the actual survival rate. With regards to our prior, this suggests we want a prior that puts most of the weight <span class="math inline">\(&gt;80\%\)</span> but is wide enough to reflect our uncertainty about the actual survival rates.</p>
<div id="turning-our-expertise-into-a-prior" class="section level3">
<h3 class="hasAnchor">
<a href="#turning-our-expertise-into-a-prior" class="anchor"></a>Turning our expertise into a prior</h3>
<p>When modeling a continuous random variable that must be between 0 and 1 (i.e., a probability), the beta distribution is a natural choice. The shape of the beta distribution is governed by two parameters, <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span></p>
<p><img src="priors_files/figure-html/unnamed-chunk-1-1.png" width="576" style="display: block; margin: auto;"></p>
<p>We learned in lecture how to turn the mean and variance of a random variable into the parameters of a probability distribution using moment matching. For the beta distribution:</p>
<p><span class="math display">\[\alpha = \bigg(\frac{1-\mu}{\sigma^2}- \frac{1}{\mu} \bigg)\mu^2 \tag{1}\]</span><br><span class="math display">\[\beta = \alpha \bigg(\frac{1}{\mu}-1\bigg) \tag{2}\]</span> Given our domain expertise, a reasonable choice for the mean and variance of the prior might be <span class="math inline">\(\mu=0.9\)</span> and <span class="math inline">\(\sigma^2=0.005\)</span> (this may seem like a small variance but as you’ll see below, it actually produces a relatively diffuse prior. Figuring out an appropriate variance for probabilities is not easy so the best option is usually to play with a few values and then explore the properties of the resulting distribution to make sure it seems reasonable). Plugging those values into equations 1 and 2 gives:</p>
<p><span class="math display">\[\alpha = \bigg(\frac{1-0.9}{0.005}- \frac{1}{0.9} \bigg)0.9^2 = 15.3\]</span> <span class="math display">\[\beta = 3.6 \bigg(\frac{1}{0.9}-1\bigg) = 1.7\]</span></p>
<p>As always, we should visualize this distribution to make sure it matches what we think it should look like:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Target mean and variance
mu &lt;-<span class="st"> </span><span class="fl">0.9</span>
var &lt;-<span class="st"> </span><span class="fl">0.005</span>

## Beta parameters
alpha &lt;-<span class="st"> </span>mu<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>((<span class="dv">1</span><span class="op">-</span>mu)<span class="op">/</span>var <span class="op">-</span><span class="st"> </span>(<span class="dv">1</span><span class="op">/</span>mu))
beta &lt;-<span class="st"> </span>alpha <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">/</span>mu <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)

## Range of possible survival probabilities
phi &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">0.001</span>)


beta_df &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">phi =</span> phi,
                      <span class="dt">density =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Beta">dbeta</a></span>(phi, alpha, beta),
                      <span class="dt">Approach =</span> <span class="st">"Domain expertise"</span>)

<span class="kw">ggplot</span>(beta_df, <span class="kw">aes</span>(<span class="dt">x =</span> phi, <span class="dt">y =</span> density, <span class="dt">color =</span> Approach)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_path</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/expression">expression</a></span>(phi), <span class="dt">limits =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.5</span>, <span class="dv">1</span>)) </code></pre></div>
<p><img src="priors_files/figure-html/unnamed-chunk-2-1.png" width="576" style="display: block; margin: auto;"></p>
<p>This seems reasonable given our understanding of the species biology. However, because we essentially made up the variance term to give a relatively diffuse prior, we would likely have to be very careful about how we justified this choice and would probably need to include some formal prior sensitivity analyses.</p>
</div>
</div>
<div id="example-2-published-studies" class="section level2">
<h2 class="hasAnchor">
<a href="#example-2-published-studies" class="anchor"></a>Example 2: Published studies</h2>
<p>Polar bears are relatively well-studied so we would not be surprised to find at least a few published estimates of adult female survival. As it turns out, there are. Estimates from a few of these studies are included as a small data frame in the WILD6900 package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(<span class="st">"SurvPriorData"</span>)</code></pre></div>
<p>Rather than rely solely on our domain expertise a better option would be to convert these published estimates into a prior distribution. There are many ways this could be done. Below we will explore several.</p>
<div id="approach-1-mean-and-variance-of-published-estimates" class="section level3">
<h3 class="hasAnchor">
<a href="#approach-1-mean-and-variance-of-published-estimates" class="anchor"></a>Approach 1: Mean and variance of published estimates</h3>
<p>One reasonable way to turn the 6 published estimates into a single prior is to take the mean and the variance of the 6 estimates and then use moment matching to convert them into a single beta distribution.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
(mu2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/mean">mean</a></span>(SurvPriorData<span class="op">$</span>phi))
<span class="co">#&gt; [1] 0.935</span>
(var2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/sd">sd</a></span>(SurvPriorData<span class="op">$</span>phi) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)
<span class="co">#&gt; [1] 0.00027</span></code></pre></div>
<p>Looks like our domain knowledge wasn’t too far off! Now we can covert these estimates into the <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> parameters as we did above:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
## Beta parameters
alpha2 &lt;-<span class="st"> </span>mu2<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>((<span class="dv">1</span><span class="op">-</span>mu2)<span class="op">/</span>var2 <span class="op">-</span><span class="st"> </span>(<span class="dv">1</span><span class="op">/</span>mu2))
beta2 &lt;-<span class="st"> </span>alpha2 <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">/</span>mu2 <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)

beta_df2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">phi =</span> phi,
                      <span class="dt">density =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Beta">dbeta</a></span>(phi, alpha2, beta2),
                      <span class="dt">Approach =</span> <span class="st">"Published means"</span>)

beta_df &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span>(beta_df, beta_df2)

<span class="kw">ggplot</span>(beta_df, <span class="kw">aes</span>(<span class="dt">x =</span> phi, <span class="dt">y =</span> density, <span class="dt">color =</span> Approach)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_path</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/expression">expression</a></span>(phi), <span class="dt">limits =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.5</span>, <span class="dv">1</span>))</code></pre></div>
<p><img src="priors_files/figure-html/unnamed-chunk-5-1.png" width="576" style="display: block; margin: auto;"></p>
<p>As you can see, even though the means of the two priors are not that different, the variance is much smaller on the prior based on published estimates, resulting in a much more informative prior (this prior suggests we’re much more sure about the plausible values of <span class="math inline">\(\phi\)</span>).</p>
</div>
<div id="approach-2-mean-and-variance-of-published-estimates" class="section level3">
<h3 class="hasAnchor">
<a href="#approach-2-mean-and-variance-of-published-estimates" class="anchor"></a>Approach 2: Mean and variance of published estimates</h3>
<p>One of the reasons the informative prior based on published survival estimates is so narrow is that it ignores the study-specific uncertainties associated with each survival estimate. One could argue that ignoring this source of uncertainty leads to a prior that is too confident in the possible values of <span class="math inline">\(\phi\)</span>.</p>
<p>However, incorporating study-specific uncertainty is not so straightforward. One clever approach is to convert estimates from each study into separate beta distributions, simulate survival estimates from each distribution, and then estimate “hyper-parameters” from all of the simulations together<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>. Understanding how this approach works is best done through example.</p>
<p>Let’s start by using moment matching to estimate the <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> parameters associated with each individual study. To do this, we’ll take advantage of the way <code>R</code> performs operations on vectors so we can just plug the columns from the data frame directly into our formulas:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(alpha3 &lt;-<span class="st"> </span>SurvPriorData<span class="op">$</span>phi<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>((<span class="dv">1</span><span class="op">-</span>SurvPriorData<span class="op">$</span>phi)<span class="op">/</span>SurvPriorData<span class="op">$</span>se<span class="op">^</span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">1</span><span class="op">/</span>SurvPriorData<span class="op">$</span>phi)))
<span class="co">#&gt; [1] 111.86  41.40  27.25 131.60 131.60  81.90</span>
(beta3 &lt;-<span class="st"> </span>alpha3 <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">/</span>SurvPriorData<span class="op">$</span>phi <span class="op">-</span><span class="st"> </span><span class="dv">1</span>))
<span class="co">#&gt; [1] 5.887 3.600 1.434 8.400 8.400 8.100</span></code></pre></div>
<p>Next, we will simulate a bunch of survival estimates from each distribution. The easiest way to do this is to create an empty matrix to hold all of the values and then loop through each study to simulate the survival probabilities:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Number of simulated values from each distribution.
nSims &lt;-<span class="st"> </span><span class="dv">5000</span>

## Empty matrix to store the simulated survival probabilities
sim_phi &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="ot">NA</span>, <span class="dt">nrow =</span> nSims, <span class="dt">ncol =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/dim">dim</a></span>(SurvPriorData)[<span class="dv">1</span>])

<span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/dim">dim</a></span>(SurvPriorData)[<span class="dv">1</span>]){
 sim_phi[,j] &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Beta">rbeta</a></span>(<span class="dt">n =</span> nSims, alpha3[j], beta3[j])
}</code></pre></div>
<p>Now hopefully you can see why this approach is so clever. We now have 30000 plausible values of adult female survival probability that are consistent with published studies and reflect multiple sources of uncertainty about this vital rate<a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a>.</p>
<p>From these simulated values, we can now estimate “hyper-parameters” for a single beta distribution that will serve as our prior. First, we estimate the mean and variance of the simulated values:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(mu3 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/mean">mean</a></span>(sim_phi))
<span class="co">#&gt; [1] 0.935</span>
(var3 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/sd">sd</a></span>(sim_phi) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)
<span class="co">#&gt; [1] 0.001124</span></code></pre></div>
<p>You can see that the variance of these samples is much larger than for approach 1, reflecting the additional source of uncertainty in approach 2. Now we use the same moment matching code as before to generate and visualize the prior:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Beta parameters
alpha4 &lt;-<span class="st"> </span>mu3<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>((<span class="dv">1</span><span class="op">-</span>mu3)<span class="op">/</span>var3 <span class="op">-</span><span class="st"> </span>(<span class="dv">1</span><span class="op">/</span>mu3))
beta4 &lt;-<span class="st"> </span>alpha4 <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">/</span>mu3 <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)

beta_df3 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">phi =</span> phi,
                      <span class="dt">density =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Beta">dbeta</a></span>(phi, alpha4, beta4),
                      <span class="dt">Approach =</span> <span class="st">"Simulated"</span>)

beta_df &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span>(beta_df, beta_df3)

sim_df &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">x =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(sim_phi))

<span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">data =</span> sim_df, <span class="kw">aes</span>(x, <span class="kw">stat</span>(density)), <span class="dt">alpha =</span> <span class="fl">0.4</span>,
                 <span class="dt">color =</span> <span class="st">"grey50"</span>,
                 <span class="dt">fill =</span>  WILD6900_colors<span class="op">$</span>value[WILD6900_colors<span class="op">$</span>name <span class="op">==</span><span class="st"> "success"</span>], 
                 <span class="dt">binwidth =</span> <span class="fl">0.005</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_path</span>(<span class="dt">data =</span> beta_df, <span class="kw">aes</span>(<span class="dt">x =</span> phi, <span class="dt">y =</span> density, <span class="dt">color =</span> Approach)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/expression">expression</a></span>(phi), <span class="dt">limits =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.7</span>, <span class="dv">1</span>)) </code></pre></div>
<p><img src="priors_files/figure-html/unnamed-chunk-9-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="questions-to-consider3" class="section level2">
<h2 class="hasAnchor">
<a href="#questions-to-consider3" class="anchor"></a>Questions to consider<a href="#fn3" class="footnoteRef" id="fnref3"><sup>3</sup></a>
</h2>
<ol style="list-style-type: decimal">
<li><p><strong>Informative vs vague</strong>: On one hand, we want posteriors to reflect (and be affected by) prior knowledge. On the other hand, why collect more data if we basically know the answer?</p></li>
<li><p><strong>How to assess ‘sensitivity to the prior’</strong>: Ideally, we should test how sensitive our inferences are to the choice of prior distribution. Should this be quantified by a change in the posterior mean, standard deviation, etc? If the posterior is unaffected by the prior, why go through the trouble of using informative priors?</p></li>
<li><p><strong>Process vs sampling noise</strong>: The studies used to create the priors reflect a range of conditions and population trajectories. In approach 1, we assume that the point estimates of survival reflect the process noise across populations. In approach 2, we use the uncertainty from each study to capture both the sampling and process uncertainty. Which sources of uncertainty should we care about when developing a prior?</p></li>
<li><p><strong>Domain expertise</strong>: Incorporating sampling uncertainty may increased prior weight for survival values that conflict with our domain expertise (for example, values much lower than we think are plausible). However, these values are consistent with possible survival values from published studies. How should we treat priors that are at the boundary of our statistical and domain expertise?</p></li>
</ol>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<p>Ramsay, M.A. and Stirling, I., 1988. Reproductive biology and ecology of female polar bears (<em>Ursus maritimus</em>). <em>Journal of Zoology</em>, 214(4), pp.601-633.</p>
<p>Regehr, E.V., Hostetter, N.J., Wilson, R.R., Rode, K.D., Martin, M.S. and Converse, S.J., 2018. Integrated population modeling provides the first empirical estimates of vital rates and abundance for polar bears in the Chukchi Sea. <em>Scientific reports</em>, 8(1), p.16780.</p>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>h/t to Nathan Hostetter, a USGS researcher, for supplying example code and data to implement these ideas.<a href="#fnref1">↩</a></p></li>
<li id="fn2"><p>Beyond this specific example, simulating data from your prior is a very useful way to ensure that the prior produces values are consistent with your domain expertise. Although we will not go into the details in this class, simulating data from the priors (called <em>prior predictive checks</em>) and then checking that these simulated data are generally consistent with plausible values you would expect in real data is a potentially important step in Bayesian inference, especially for complicated models where interactions between multiple parameters can potentially generate unexpected support for implausible data. For more information about doing prior predictive checks, see this <a href="https://betanalpha.github.io/assets/case_studies/principled_bayesian_workflow.html">great overview</a> from Michael Betancourt.<a href="#fnref2">↩</a></p></li>
<li id="fn3"><p>h/t again to Nathan Hostetter for engaging discussions about these issues<a href="#fnref3">↩</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#question-and-model-development">Question and model development</a></li>
      <li><a href="#example-1-domain-expertise">Example 1: Domain expertise</a></li>
      <li><a href="#example-2-published-studies">Example 2: Published studies</a></li>
      <li><a href="#questions-to-consider3">Questions to consider</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Clark Rushing.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
