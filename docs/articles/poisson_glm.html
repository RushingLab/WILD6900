<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Poisson GLM for modeling count data • WILD6900</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Poisson GLM for modeling count data">
<meta property="og:description" content="WILD6900">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">WILD6900</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2021.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home"></span>
     
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/syllabus.html">
    <span class="fas fa-book"></span>
     
    Syllabus
  </a>
</li>
<li>
  <a href="../articles/schedule.html">
    <span class="fas fa-calendar"></span>
     
    Schedule
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-file-pdf-o"></span>
     
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Lecture0/Lecture0.html">Lecture 0: Introduction to WILD6900</a>
    </li>
    <li>
      <a href="../articles/Lecture1/Lecture1.html">Lecture 1: Introduction to statistical inference in ecology</a>
    </li>
    <li>
      <a href="../articles/Lecture2/Lecture2.html">Lecture 2: Probability refresher (or introduction)</a>
    </li>
    <li>
      <a href="../articles/Lecture3/Lecture3.html">Lecture 3: Principles of Bayesian inference</a>
    </li>
    <li>
      <a href="../articles/Lecture4/Lecture4.html">Lecture 4: More about prior distributions</a>
    </li>
    <li>
      <a href="../articles/Lecture5/Lecture5.html">Lecture 5: Implementing Bayesian models: Introduction to MCMC samplers</a>
    </li>
    <li>
      <a href="../articles/Lecture6/Lecture6.html">Lecture 6: Introduction of Bayesian analysis using JAGS</a>
    </li>
    <li>
      <a href="../articles/Lecture7/Lecture7.html">Lecture 7: Generalized linear model review</a>
    </li>
    <li>
      <a href="../articles/Lecture8/Lecture8.html">Lecture 8: Introduction to hierarchical models</a>
    </li>
    <li>
      <a href="../articles/Lecture9/Lecture9.html">Lecture 9: Introduction to state-space models</a>
    </li>
    <li>
      <a href="../articles/Lecture10/Lecture10.html">Lecture 10: Estimating abundance: N-mixture models</a>
    </li>
    <li>
      <a href="../articles/Lecture11/Lecture11.html">Lecture 11: Estimating abundance: Occupancy modeling</a>
    </li>
    <li>
      <a href="../articles/Lecture12/Lecture12.html">Lecture 12: Estimating abundance: Closed-population capture-mark-recapture</a>
    </li>
    <li>
      <a href="../articles/Lecture13/Lecture13.html">Lecture 13: Estimating survival: Open-population capture-mark-recapture</a>
    </li>
    <li>
      <a href="../articles/Lecture14/Lecture14.html">Lecture 14: Estimating abundance and survival: Open-population capture-mark-recapture</a>
    </li>
    <li>
      <a href="../articles/Lecture15/Lecture15.html">Lecture 15: Multi-state models</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-desktop"></span>
     
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/projects_and_directories.html">Projects and directories</a>
    </li>
    <li>
      <a href="../articles/rmarkdown_intro.html">Introduction to R Markdown</a>
    </li>
    <li>
      <a href="../articles/priors.html">Creating prior distributions</a>
    </li>
    <li>
      <a href="../articles/simulation.html">Simulating regression data</a>
    </li>
    <li>
      <a href="../articles/metropolis.html">Metropolis sampler for linear regression model</a>
    </li>
    <li>
      <a href="../articles/poisson_glm.html">Poisson and binomial GLMs in JAGS</a>
    </li>
    <li>
      <a href="../articles/random_effects.html">Random effects ANCOVA in JAGS</a>
    </li>
    <li>
      <a href="../articles/state_space.html">Simple state-space models in JAGS</a>
    </li>
    <li>
      <a href="../articles/state_space2.html">Age-structured state-space models</a>
    </li>
    <li>
      <a href="../articles/n-mixture1.html">Introduction to N-mixture models</a>
    </li>
    <li>
      <a href="../articles/n-mixture2.html">Advanced N-mixture models: Zero-inflation and posterior predictive checks</a>
    </li>
    <li>
      <a href="../articles/multi_spp_occ.html">Estimating species richness using hierarchical occupancy models</a>
    </li>
    <li>
      <a href="../articles/cjs.html">Cormack-Jolly-Seber models</a>
    </li>
    <li>
      <a href="../articles/multi-state.html">Quantifying temporary emigration using multi-state models</a>
    </li>
    <li>
      <a href="../articles/multi-state2.html">Multi-state model for survival/transition probability of a perennial plant</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/homework.html">
    <span class="fas fa-pencil-square-o"></span>
     
    Assignments
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="poisson_glm_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Poisson GLM for modeling count data</h1>
                        <h4 class="author">WILD6900</h4>
            
            <h4 class="date">2021-01-05</h4>
      
      
      <div class="hidden name"><code>poisson_glm.Rmd</code></div>

    </div>

    
    
<p>In this activity, we will analyze a small data set containing counts of both population size and reproductive success using Poisson and Binomial GLMs.</p>
<hr>
<p><strong>Objectives</strong></p>
<ul>
<li><p>Analyze count data using Poisson and Binomial GLMs</p></li>
<li><p>Gain experience diagnosing JAGS output to check convergence</p></li>
<li>
<p><code>R</code> functions used in this exercise:</p>
<ul>
<li><code><a href="https://rdrr.io/r/base/system.file.html">system.file()</a></code></li>
</ul>
</li>
</ul>
<hr>
<div id="data" class="section level2">
<h2 class="hasAnchor">
<a href="#data" class="anchor"></a>Data</h2>
<p>The data for this activity comes from a long-term project that monitored a population of peregrine falcons nesting in the <a href="https://en.wikipedia.org/wiki/Jura_(department)">French Jura</a> from 1964 to 2003 <a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>.</p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/7/7b/Peregrine_falcon_%28Australia%29.JPG" width="75%" style="display: block; margin: auto;"></p>
<p>Load and inspect the data:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">WILD6900</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"falcons"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">falcons</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr>
<th style="text-align:right;">
Year
</th>
<th style="text-align:right;">
Pairs
</th>
<th style="text-align:right;">
R.Pairs
</th>
<th style="text-align:right;">
Eyasses
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
1964
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
27
</td>
</tr>
<tr>
<td style="text-align:right;">
1965
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
30
</td>
</tr>
<tr>
<td style="text-align:right;">
1966
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
36
</td>
</tr>
<tr>
<td style="text-align:right;">
1967
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
37
</td>
</tr>
<tr>
<td style="text-align:right;">
1968
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
19
</td>
</tr>
<tr>
<td style="text-align:right;">
1969
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
10
</td>
</tr>
</tbody>
</table>
<p>To see what each column represents, type:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">?</span><span class="va">falcons</span></code></pre></div>
</div>
<div id="analysis-1-change-in-population-size" class="section level2">
<h2 class="hasAnchor">
<a href="#analysis-1-change-in-population-size" class="anchor"></a>Analysis 1: Change in population size</h2>
<p>The first model we will fit examines change in the number of adult falcon pairs over time. Plotting the data shows that this change has not been linear:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="va">falcons</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, y <span class="op">=</span> <span class="va">Pairs</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">stat_smooth</span><span class="op">(</span>se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="poisson_glm_files/figure-html/unnamed-chunk-5-1.png" width="576" style="display: block; margin: auto;"></p>
<p>After a short decline at the beginning of the study period, the population then increased dramatically before perhaps reaching its carrying capacity.</p>
<div id="modeling-non-linear-effects-using-linear-models" class="section level3">
<h3 class="hasAnchor">
<a href="#modeling-non-linear-effects-using-linear-models" class="anchor"></a>Modeling non-linear effects using linear models</h3>
<p>How can we model the non-linear change in abundance if, by definition, linear models model linear effects? Using polynomials!</p>
<p>Remember the equation for a curved line with a single peak (or bottom):</p>
<p><span class="math display">\[\Large y = a + b \times x + c \times x^2\]</span></p>
<p><img src="poisson_glm_files/figure-html/unnamed-chunk-6-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Where <span class="math inline">\(a\)</span> is the maximum (or minimum) value of <span class="math inline">\(y\)</span>, <span class="math inline">\(b\)</span> is the value of <span class="math inline">\(x\)</span> where this maximum (or minimum) occurs and <span class="math inline">\(c\)</span> determines whether the peak is a maximum (<span class="math inline">\(c&lt;0\)</span>) or a minimum (<span class="math inline">\(c&gt;0\)</span>).</p>
<p>We can add more complex shape by adding additional polynomial terms. For example, including a cubic term creates an s-shaped curve:</p>
<p><span class="math display">\[\Large y = a + b \times x + c \times x^2 + d \times x^3\]</span></p>
<p><img src="poisson_glm_files/figure-html/unnamed-chunk-7-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Including polynomial terms in the linear predictor on the model gives us enormous flexibility to model non-linear relationships using GLMs.</p>
</div>
<div id="modeling-change-in-falcon-counts" class="section level3">
<h3 class="hasAnchor">
<a href="#modeling-change-in-falcon-counts" class="anchor"></a>Modeling change in falcon counts</h3>
<p>To build a model for the falcon data, we need to define the components required in all GLMs (the distribution, link function, and linear predictor). Because these are counts, a natural choice for the distribution is:</p>
<p><span class="math display">\[C_t \sim Poisson(\lambda_t)\]</span> where <span class="math inline">\(C_t\)</span> is the observed count in year <span class="math inline">\(t\)</span> and <span class="math inline">\(\lambda_t\)</span> is the expected count.</p>
<p>As we learned in lecture, the conventional link function for count data is the log-link:</p>
<p><span class="math display">\[log(\lambda_t) = log(E(\lambda_t))\]</span></p>
<p>Finally, we need to write the linear predictor. Based on the preliminary visualization of the data, a cubic polynomial might be appropriate to capture the non-linear change over time:</p>
<p><span class="math display">\[log(\lambda_t) = \alpha + \beta_1 \times year_t + \beta_2 \times year^2_t + \beta_3 \times year^3_t\]</span></p>
</div>
<div id="accessing-and-viewing-the-jags-model" class="section level3">
<h3 class="hasAnchor">
<a href="#accessing-and-viewing-the-jags-model" class="anchor"></a>Accessing and viewing the JAGS model</h3>
<p>A JAGS model file that corresponds to the above model is already included in the <code>WILD6900</code> package. You can access that file and view the model using the following code:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod.file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"jags/GLM_Poisson.jags"</span>, package <span class="op">=</span> <span class="st">"WILD6900"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/file.show.html">file.show</a></span><span class="op">(</span><span class="va">mod.file</span><span class="op">)</span></code></pre></div>
<pre class="eval"><code>model {

  # Priors
  alpha ~ dnorm(0, 0.33)
  beta1 ~ dnorm(0, 0.33)
  beta2 ~ dnorm(0, 0.33)
  beta3 ~ dnorm(0, 0.33)

  # Likelihooda
  for (i in 1:n){
    C[i] ~ dpois(lambda[i])
    log(lambda[i]) &lt;- alpha + beta1 * year[i] + beta2 * pow(year[i],2) + beta3 * pow(year[i],3)
  } #i
}</code></pre>
<p>From this file, you can see that we will use relatively non-informative normal priors on each of the regression coefficients.</p>
<p>You can also see that the likelihood statement is very similar to the linear regression model from the last lecture, with a few minor differences. First, because we assume the observed falcon counts come from a Poisson distribution, we use <code><a href="https://rdrr.io/r/stats/Poisson.html">dpois(lambda[i])</a></code> rather than <code><a href="https://rdrr.io/r/stats/Normal.html">dnorm(mu[i], tau)</a></code>. Also, we have to apply the log-link function to the predicted counts (<code>log(lambda[i])=...</code>). Notice that JAGS allows you to model the transformed predicted counts on the left hand side of the linear predictor equation</p>
<hr>
<p><strong>Questions</strong></p>
<ol style="list-style-type: decimal">
<li><p>Plot a histogram of random samples from the normal prior used in the model (remember to convert the precision of <code>0.33</code> to standard deviation). As you can see, this is not as vague as the normal priors we have used in the past. What is the advantage of using less-vague normal priors?</p></li>
<li><p>In the linear regression model we fit in the last lecture, we also had a prior for <span class="math inline">\(\tau\)</span>, the (inverse) of the process variance. Why do we not include that parameter in this model?</p></li>
<li><p>Creating the <code>lambda[i]</code> object is not strictly necessary since it is a deterministic function of year. If you wanted to have fewer lines of code, you could include the linear predictor directly inside of the <code><a href="https://rdrr.io/r/stats/Poisson.html">dpois()</a></code> function instead of <code>lambda[i]</code>, though you would need to appropriately transform the linear predictor. What transformation would you use to put the linear predictor on the count scale?</p></li>
</ol>
<hr>
</div>
<div id="fitting-the-model" class="section level3">
<h3 class="hasAnchor">
<a href="#fitting-the-model" class="anchor"></a>Fitting the model</h3>
<p>Before fitting the model, we need to prepare the input for JAGS. This includes:</p>
<ul>
<li><p>storing the data as a named list</p></li>
<li><p>creating a function to randomly generate the initial values for each parameter</p></li>
<li><p>creating a vector with the parameters we want JAGS to monitor</p></li>
<li><p>set the MCMC settings</p></li>
</ul>
<p>We’ve mentioned several times, it’s often a bad idea to include covariate values that are too far from 0. For this reason, we will first scale <code>year</code> to <span class="math inline">\(mean=0\)</span> and <span class="math inline">\(sd=1\)</span>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">year</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">falcons</span><span class="op">$</span><span class="va">Year</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">falcons</span><span class="op">$</span><span class="va">Year</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">falcons</span><span class="op">$</span><span class="va">Year</span><span class="op">)</span>

<span class="va">jags_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>C <span class="op">=</span> <span class="va">falcons</span><span class="op">$</span><span class="va">Pairs</span>, year <span class="op">=</span> <span class="va">year</span>, n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">falcons</span><span class="op">)</span><span class="op">)</span>

<span class="va">jags_inits</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, beta1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, beta2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, beta3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">}</span>

<span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"alpha"</span>, <span class="st">"beta1"</span>, <span class="st">"beta2"</span>, <span class="st">"beta3"</span>, <span class="st">"lambda"</span><span class="op">)</span>

<span class="va">nC</span> <span class="op">&lt;-</span> <span class="fl">3</span>

<span class="va">nI</span> <span class="op">&lt;-</span> <span class="fl">10000</span>

<span class="va">nB</span> <span class="op">&lt;-</span> <span class="fl">2500</span>

<span class="va">nT</span> <span class="op">&lt;-</span> <span class="fl">1</span></code></pre></div>
<p>Now we’re ready to run the model:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">falcon_mod</span> <span class="op">&lt;-</span> <span class="fu">jagsUI</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jagsUI/man/jags.html">jags</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">jags_data</span>, inits <span class="op">=</span> <span class="va">jags_inits</span>, 
                           parameters.to.save <span class="op">=</span> <span class="va">params</span>, 
                           model.file <span class="op">=</span> <span class="va">mod.file</span>, 
                           n.chains <span class="op">=</span> <span class="va">nC</span>, n.iter <span class="op">=</span> <span class="va">nI</span>, 
                           n.burnin <span class="op">=</span> <span class="va">nB</span>, n.thin <span class="op">=</span> <span class="va">nT</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Processing function input....... </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Done. </span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; Compiling model graph</span>
<span class="co">#&gt;    Resolving undeclared variables</span>
<span class="co">#&gt;    Allocating nodes</span>
<span class="co">#&gt; Graph information:</span>
<span class="co">#&gt;    Observed stochastic nodes: 40</span>
<span class="co">#&gt;    Unobserved stochastic nodes: 4</span>
<span class="co">#&gt;    Total graph size: 349</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Initializing model</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Adaptive phase..... </span>
<span class="co">#&gt; Adaptive phase complete </span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Burn-in phase, 2500 iterations x 3 chains </span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sampling from joint posterior, 7500 iterations x 3 chains </span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Calculating statistics....... </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Done.</span></code></pre></div>
<p>View a portion of the results (printing all of the <code>lambda</code> values takes up too much room):</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">falcon_mod</span><span class="op">$</span><span class="va">summary</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="op">]</span></code></pre></div>
<table class="table">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
2.5%
</th>
<th style="text-align:right;">
25%
</th>
<th style="text-align:right;">
50%
</th>
<th style="text-align:right;">
75%
</th>
<th style="text-align:right;">
97.5%
</th>
<th style="text-align:right;">
Rhat
</th>
<th style="text-align:right;">
n.eff
</th>
<th style="text-align:right;">
overlap0
</th>
<th style="text-align:right;">
f
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
alpha
</td>
<td style="text-align:right;">
4.2317
</td>
<td style="text-align:right;">
0.0301
</td>
<td style="text-align:right;">
4.1721
</td>
<td style="text-align:right;">
4.2115
</td>
<td style="text-align:right;">
4.2319
</td>
<td style="text-align:right;">
4.2520
</td>
<td style="text-align:right;">
4.2907
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
22500
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
beta1
</td>
<td style="text-align:right;">
1.1153
</td>
<td style="text-align:right;">
0.0477
</td>
<td style="text-align:right;">
1.0218
</td>
<td style="text-align:right;">
1.0830
</td>
<td style="text-align:right;">
1.1152
</td>
<td style="text-align:right;">
1.1473
</td>
<td style="text-align:right;">
1.2092
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
22500
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
beta2
</td>
<td style="text-align:right;">
0.0059
</td>
<td style="text-align:right;">
0.0242
</td>
<td style="text-align:right;">
-0.0421
</td>
<td style="text-align:right;">
-0.0103
</td>
<td style="text-align:right;">
0.0060
</td>
<td style="text-align:right;">
0.0223
</td>
<td style="text-align:right;">
0.0527
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
14586
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.6007
</td>
</tr>
<tr>
<td style="text-align:left;">
beta3
</td>
<td style="text-align:right;">
-0.2325
</td>
<td style="text-align:right;">
0.0251
</td>
<td style="text-align:right;">
-0.2820
</td>
<td style="text-align:right;">
-0.2493
</td>
<td style="text-align:right;">
-0.2324
</td>
<td style="text-align:right;">
-0.2155
</td>
<td style="text-align:right;">
-0.1836
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
14889
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
lambda[1]
</td>
<td style="text-align:right;">
32.1846
</td>
<td style="text-align:right;">
3.2008
</td>
<td style="text-align:right;">
26.2708
</td>
<td style="text-align:right;">
29.9611
</td>
<td style="text-align:right;">
32.0562
</td>
<td style="text-align:right;">
34.2767
</td>
<td style="text-align:right;">
38.8524
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5548
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
lambda[2]
</td>
<td style="text-align:right;">
30.1530
</td>
<td style="text-align:right;">
2.5479
</td>
<td style="text-align:right;">
25.4171
</td>
<td style="text-align:right;">
28.3835
</td>
<td style="text-align:right;">
30.0654
</td>
<td style="text-align:right;">
31.8288
</td>
<td style="text-align:right;">
35.4304
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5535
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
lambda[3]
</td>
<td style="text-align:right;">
28.7233
</td>
<td style="text-align:right;">
2.0693
</td>
<td style="text-align:right;">
24.8243
</td>
<td style="text-align:right;">
27.3004
</td>
<td style="text-align:right;">
28.6677
</td>
<td style="text-align:right;">
30.0927
</td>
<td style="text-align:right;">
32.9410
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5679
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
lambda[4]
</td>
<td style="text-align:right;">
27.7935
</td>
<td style="text-align:right;">
1.7253
</td>
<td style="text-align:right;">
24.5276
</td>
<td style="text-align:right;">
26.6171
</td>
<td style="text-align:right;">
27.7522
</td>
<td style="text-align:right;">
28.9522
</td>
<td style="text-align:right;">
31.2708
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
6105
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
lambda[5]
</td>
<td style="text-align:right;">
27.2926
</td>
<td style="text-align:right;">
1.4886
</td>
<td style="text-align:right;">
24.4605
</td>
<td style="text-align:right;">
26.2753
</td>
<td style="text-align:right;">
27.2657
</td>
<td style="text-align:right;">
28.2855
</td>
<td style="text-align:right;">
30.2921
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
7035
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
lambda[6]
</td>
<td style="text-align:right;">
27.1727
</td>
<td style="text-align:right;">
1.3392
</td>
<td style="text-align:right;">
24.6066
</td>
<td style="text-align:right;">
26.2592
</td>
<td style="text-align:right;">
27.1462
</td>
<td style="text-align:right;">
28.0620
</td>
<td style="text-align:right;">
29.8622
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
8900
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
</tbody>
</table>
<p>Notice that all <code>Rhat</code> are less than 1.1, indicating that all parameters appear to have converged. Also note <code>f</code> for <code>beta2</code> - the posterior mean is 0.006 but there is only a 60.1% probability that it is greater than 0.</p>
<p>As usual, let’s check the trace plots to see how they look:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># View traceplots for alpha, beta1, beta2, and beta3 (not for lambda)</span>
<span class="fu">jagsUI</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jagsUI/man/traceplot.html">traceplot</a></span><span class="op">(</span><span class="va">falcon_mod</span>, parameters<span class="op">=</span><span class="va">params</span><span class="op">[</span><span class="op">-</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="poisson_glm_files/figure-html/unnamed-chunk-14-1.png" width="700" style="display: block; margin: auto;"><img src="poisson_glm_files/figure-html/unnamed-chunk-14-2.png" width="700" style="display: block; margin: auto;"><img src="poisson_glm_files/figure-html/unnamed-chunk-14-3.png" width="700" style="display: block; margin: auto;"><img src="poisson_glm_files/figure-html/unnamed-chunk-14-4.png" width="700" style="display: block; margin: auto;"></p>
<p>By monitoring <code>lambda</code> we can also plot the predicted counts along with the observed counts. First, we add the posterior means and upper/lower bounds of the 95% credible interval to the falcons data frame, then use ggplot to visualize:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">falcons</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">falcons</span>, lambda <span class="op">=</span> <span class="va">falcon_mod</span><span class="op">$</span><span class="va">mean</span><span class="op">$</span><span class="va">lambda</span>, 
                                  q2.5 <span class="op">=</span> <span class="va">falcon_mod</span><span class="op">$</span><span class="va">q2.5</span><span class="op">$</span><span class="va">lambda</span>, 
                                  q97.5 <span class="op">=</span> <span class="va">falcon_mod</span><span class="op">$</span><span class="va">q97.5</span><span class="op">$</span><span class="va">lambda</span><span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span><span class="va">falcons</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_ribbon</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, ymin <span class="op">=</span> <span class="va">q2.5</span>, ymax <span class="op">=</span> <span class="va">q97.5</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">"grey90"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_path</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, y <span class="op">=</span> <span class="va">lambda</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, y <span class="op">=</span> <span class="va">Pairs</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_y_continuous</span><span class="op">(</span><span class="st">"Pairs"</span><span class="op">)</span></code></pre></div>
<p><img src="poisson_glm_files/figure-html/unnamed-chunk-15-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="analysis-2-nest-success-model" class="section level2">
<h2 class="hasAnchor">
<a href="#analysis-2-nest-success-model" class="anchor"></a>Analysis 2: Nest success model</h2>
<p>Next, let’s use the <code>falcons</code> data set to fit another type of GLM - the binomial GLM. Hopefully this exercise will show you that once you’re comfortable writing out and coding the GLM components (distribution, link function, and linear predictor), it is extremely easy to fit models with different distributional assumptions.</p>
<p>To estimate reproductive success (i.e., the probability that a pair successfully produces offspring), we will model the number of reproductive pairs (<code>falcons$R.Pairs</code>) as a function of the total number of pairs (<code>falcons$Pairs</code>).</p>
<p>Because the total number of reproductive pairs cannot exceed the total number of pairs, the counts in <code>falcons$.RPairs</code> are bounded to be less than <code>falcons$Pairs</code>. In this case, the Poisson distribution is not an appropriate count model. Instead, we will use the binomial distribution:</p>
<p><span class="math display">\[C_t \sim binomial(N_t, p_t)\]</span></p>
<p>Our goal is to model <span class="math inline">\(p_t\)</span>, the probability of nesting successfully in each year. In this case, the log link is not appropriate - <span class="math inline">\(p_t\)</span> is bound between 0 and 1. For probabilities, the logit link is generally the appropriate link function:</p>
<p><span class="math display">\[logit(p_t) = log\bigg(\frac{p_t}{1-p_t}\bigg)\]</span></p>
<p>Following Kéry &amp; Schaub, we’ll model probability as a quadratic function of year:</p>
<p><span class="math display">\[logit(p_t) = \alpha + \beta_1 \times year_t + \beta_2 \times year^2_t\]</span></p>
<p>As in the last example, there is a JAGS model file available in the <code>WILD6900</code> package:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod.file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"jags/GLM_Binomial.jags"</span>, package <span class="op">=</span> <span class="st">"WILD6900"</span><span class="op">)</span></code></pre></div>
<p>However, before looking at it, see if you can write out the model in the BUGS language (use the same priors from the previous example and note that there is a built in <code>logit()</code> function).</p>
<p>As before, we prepare the data and run the model:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">year</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">falcons</span><span class="op">$</span><span class="va">Year</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">falcons</span><span class="op">$</span><span class="va">Year</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">falcons</span><span class="op">$</span><span class="va">Year</span><span class="op">)</span>

<span class="va">jags_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>C <span class="op">=</span> <span class="va">falcons</span><span class="op">$</span><span class="va">R.Pairs</span>, N <span class="op">=</span> <span class="va">falcons</span><span class="op">$</span><span class="va">Pairs</span>, year <span class="op">=</span> <span class="va">year</span>, nyears <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">falcons</span><span class="op">)</span><span class="op">)</span>

<span class="va">jags_inits</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, beta1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, beta2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, beta3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">}</span>

<span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"alpha"</span>, <span class="st">"beta1"</span>, <span class="st">"beta2"</span>, <span class="st">"p"</span><span class="op">)</span>

<span class="va">nC</span> <span class="op">&lt;-</span> <span class="fl">3</span>

<span class="va">nI</span> <span class="op">&lt;-</span> <span class="fl">10000</span>

<span class="va">nB</span> <span class="op">&lt;-</span> <span class="fl">2500</span>

<span class="va">nT</span> <span class="op">&lt;-</span> <span class="fl">1</span>

<span class="va">falcon_mod</span> <span class="op">&lt;-</span> <span class="fu">jagsUI</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jagsUI/man/jags.html">jags</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">jags_data</span>, inits <span class="op">=</span> <span class="va">jags_inits</span>, 
                           parameters.to.save <span class="op">=</span> <span class="va">params</span>, 
                           model.file <span class="op">=</span> <span class="va">mod.file</span>, 
                           n.chains <span class="op">=</span> <span class="va">nC</span>, n.iter <span class="op">=</span> <span class="va">nI</span>, 
                           n.burnin <span class="op">=</span> <span class="va">nB</span>, n.thin <span class="op">=</span> <span class="va">nT</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Processing function input....... </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Done. </span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; Compiling model graph</span>
<span class="co">#&gt;    Resolving undeclared variables</span>
<span class="co">#&gt;    Allocating nodes</span>
<span class="co">#&gt; Graph information:</span>
<span class="co">#&gt;    Observed stochastic nodes: 40</span>
<span class="co">#&gt;    Unobserved stochastic nodes: 3</span>
<span class="co">#&gt;    Total graph size: 307</span>
<span class="co">#&gt; Warning in jags.model(file = model.file, data = data, inits = inits, n.chains =</span>
<span class="co">#&gt; n.chains, : Unused initial value for "beta3" in chain 1</span>
<span class="co">#&gt; Warning in jags.model(file = model.file, data = data, inits = inits, n.chains =</span>
<span class="co">#&gt; n.chains, : Unused initial value for "beta3" in chain 2</span>
<span class="co">#&gt; Warning in jags.model(file = model.file, data = data, inits = inits, n.chains =</span>
<span class="co">#&gt; n.chains, : Unused initial value for "beta3" in chain 3</span>
<span class="co">#&gt; Initializing model</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Adaptive phase..... </span>
<span class="co">#&gt; Adaptive phase complete </span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Burn-in phase, 2500 iterations x 3 chains </span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sampling from joint posterior, 7500 iterations x 3 chains </span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Calculating statistics....... </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Done.</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">falcon_mod</span><span class="op">$</span><span class="va">summary</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="op">]</span></code></pre></div>
<table class="table">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
2.5%
</th>
<th style="text-align:right;">
25%
</th>
<th style="text-align:right;">
50%
</th>
<th style="text-align:right;">
75%
</th>
<th style="text-align:right;">
97.5%
</th>
<th style="text-align:right;">
Rhat
</th>
<th style="text-align:right;">
n.eff
</th>
<th style="text-align:right;">
overlap0
</th>
<th style="text-align:right;">
f
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
alpha
</td>
<td style="text-align:right;">
0.7814
</td>
<td style="text-align:right;">
0.0557
</td>
<td style="text-align:right;">
0.6725
</td>
<td style="text-align:right;">
0.7439
</td>
<td style="text-align:right;">
0.7809
</td>
<td style="text-align:right;">
0.8186
</td>
<td style="text-align:right;">
0.8931
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
18042
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.0
</td>
</tr>
<tr>
<td style="text-align:left;">
beta1
</td>
<td style="text-align:right;">
0.0591
</td>
<td style="text-align:right;">
0.0455
</td>
<td style="text-align:right;">
-0.0301
</td>
<td style="text-align:right;">
0.0280
</td>
<td style="text-align:right;">
0.0593
</td>
<td style="text-align:right;">
0.0908
</td>
<td style="text-align:right;">
0.1474
</td>
<td style="text-align:right;">
1.001
</td>
<td style="text-align:right;">
2224
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.9
</td>
</tr>
<tr>
<td style="text-align:left;">
beta2
</td>
<td style="text-align:right;">
-0.3035
</td>
<td style="text-align:right;">
0.0413
</td>
<td style="text-align:right;">
-0.3839
</td>
<td style="text-align:right;">
-0.3313
</td>
<td style="text-align:right;">
-0.3039
</td>
<td style="text-align:right;">
-0.2752
</td>
<td style="text-align:right;">
-0.2226
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
4660
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.0
</td>
</tr>
<tr>
<td style="text-align:left;">
p[1]
</td>
<td style="text-align:right;">
0.4599
</td>
<td style="text-align:right;">
0.0371
</td>
<td style="text-align:right;">
0.3887
</td>
<td style="text-align:right;">
0.4342
</td>
<td style="text-align:right;">
0.4596
</td>
<td style="text-align:right;">
0.4853
</td>
<td style="text-align:right;">
0.5335
</td>
<td style="text-align:right;">
1.001
</td>
<td style="text-align:right;">
2110
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.0
</td>
</tr>
<tr>
<td style="text-align:left;">
p[2]
</td>
<td style="text-align:right;">
0.4821
</td>
<td style="text-align:right;">
0.0345
</td>
<td style="text-align:right;">
0.4159
</td>
<td style="text-align:right;">
0.4582
</td>
<td style="text-align:right;">
0.4817
</td>
<td style="text-align:right;">
0.5057
</td>
<td style="text-align:right;">
0.5502
</td>
<td style="text-align:right;">
1.001
</td>
<td style="text-align:right;">
2067
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.0
</td>
</tr>
<tr>
<td style="text-align:left;">
p[3]
</td>
<td style="text-align:right;">
0.5032
</td>
<td style="text-align:right;">
0.0318
</td>
<td style="text-align:right;">
0.4421
</td>
<td style="text-align:right;">
0.4814
</td>
<td style="text-align:right;">
0.5031
</td>
<td style="text-align:right;">
0.5250
</td>
<td style="text-align:right;">
0.5660
</td>
<td style="text-align:right;">
1.001
</td>
<td style="text-align:right;">
2031
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.0
</td>
</tr>
<tr>
<td style="text-align:left;">
p[4]
</td>
<td style="text-align:right;">
0.5233
</td>
<td style="text-align:right;">
0.0292
</td>
<td style="text-align:right;">
0.4668
</td>
<td style="text-align:right;">
0.5033
</td>
<td style="text-align:right;">
0.5233
</td>
<td style="text-align:right;">
0.5432
</td>
<td style="text-align:right;">
0.5807
</td>
<td style="text-align:right;">
1.001
</td>
<td style="text-align:right;">
2006
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.0
</td>
</tr>
<tr>
<td style="text-align:left;">
p[5]
</td>
<td style="text-align:right;">
0.5422
</td>
<td style="text-align:right;">
0.0268
</td>
<td style="text-align:right;">
0.4902
</td>
<td style="text-align:right;">
0.5238
</td>
<td style="text-align:right;">
0.5422
</td>
<td style="text-align:right;">
0.5605
</td>
<td style="text-align:right;">
0.5946
</td>
<td style="text-align:right;">
1.001
</td>
<td style="text-align:right;">
1994
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.0
</td>
</tr>
<tr>
<td style="text-align:left;">
p[6]
</td>
<td style="text-align:right;">
0.5599
</td>
<td style="text-align:right;">
0.0245
</td>
<td style="text-align:right;">
0.5120
</td>
<td style="text-align:right;">
0.5430
</td>
<td style="text-align:right;">
0.5599
</td>
<td style="text-align:right;">
0.5766
</td>
<td style="text-align:right;">
0.6079
</td>
<td style="text-align:right;">
1.001
</td>
<td style="text-align:right;">
1998
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.0
</td>
</tr>
<tr>
<td style="text-align:left;">
p[7]
</td>
<td style="text-align:right;">
0.5764
</td>
<td style="text-align:right;">
0.0225
</td>
<td style="text-align:right;">
0.5327
</td>
<td style="text-align:right;">
0.5610
</td>
<td style="text-align:right;">
0.5764
</td>
<td style="text-align:right;">
0.5916
</td>
<td style="text-align:right;">
0.6203
</td>
<td style="text-align:right;">
1.001
</td>
<td style="text-align:right;">
2024
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.0
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># View traceplots for alpha, beta1, and beta2(not for p)</span>
<span class="fu">jagsUI</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jagsUI/man/traceplot.html">traceplot</a></span><span class="op">(</span><span class="va">falcon_mod</span>, parameters<span class="op">=</span><span class="va">params</span><span class="op">[</span><span class="op">-</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="poisson_glm_files/figure-html/unnamed-chunk-20-1.png" width="700" style="display: block; margin: auto;"><img src="poisson_glm_files/figure-html/unnamed-chunk-20-2.png" width="700" style="display: block; margin: auto;"><img src="poisson_glm_files/figure-html/unnamed-chunk-20-3.png" width="700" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">falcons</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">falcons</span>, p <span class="op">=</span> <span class="va">falcon_mod</span><span class="op">$</span><span class="va">mean</span><span class="op">$</span><span class="va">p</span>, 
                                  q2.5_p <span class="op">=</span> <span class="va">falcon_mod</span><span class="op">$</span><span class="va">q2.5</span><span class="op">$</span><span class="va">p</span>, 
                                  q97.5_p <span class="op">=</span> <span class="va">falcon_mod</span><span class="op">$</span><span class="va">q97.5</span><span class="op">$</span><span class="va">p</span><span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span><span class="va">falcons</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_ribbon</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, ymin <span class="op">=</span> <span class="va">q2.5_p</span>, ymax <span class="op">=</span> <span class="va">q97.5_p</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">"grey90"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_path</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, y <span class="op">=</span> <span class="va">p</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, y <span class="op">=</span> <span class="va">R.Pairs</span><span class="op">/</span><span class="va">Pairs</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_y_continuous</span><span class="op">(</span><span class="st">"Pairs"</span><span class="op">)</span></code></pre></div>
<p><img src="poisson_glm_files/figure-html/unnamed-chunk-21-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>All data and code used in this lab are from Kéry &amp; Schaub <em>Bayesian Population Analysis Using WinBugs</em> and can be accessed <a href="https://www.vogelwarte.ch/de/projekte/publikationen/bpa/complete-code-and-data-files-of-the-book">here</a><a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Clark Rushing.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
