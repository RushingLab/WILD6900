<!DOCTYPE html>
<html>
  <head>
    <title>Lecture 7</title>
    <meta charset="utf-8">
    <meta name="author" content="   WILD6900 (Spring 2019)" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link rel="stylesheet" href="WILD6900.css" type="text/css" />
    <link rel="stylesheet" href="WILD6900-fonts.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Lecture 7
## Hierarchical models and GLM review
### <br/><br/><br/>WILD6900 (Spring 2019)

---




## Readings

---
class: inverse, center, middle

# From linear models to GLMs

---
# Linear models
&lt;br/&gt;
&lt;br/&gt;
`$$\Large response = deterministic\; part+stochastic\; part$$` 
&lt;br/&gt;
&lt;br/&gt;

--
`$$\underbrace{\LARGE \mu_i = \alpha + \beta \times x_i}_{Deterministic}$$`
&lt;br/&gt;
&lt;br/&gt;

--
`$$\underbrace{\LARGE y_i \sim Normal(\mu_i, \tau)}_{Stochastic}$$`  

???

Note that the deterministic portion of the model has the same form as the equation for a line: `\(y = a + b \times x\)`, which is why we call these linear models

---
# A simple linear model: the t-test

`$$\begin{bmatrix}
    \mu_1 \\
    \mu_2 \\
    \mu_3 \\
    .\\
    .\\
    .\\
    \mu_N
\end{bmatrix}= \begin{bmatrix}
    1  &amp; x_1\\
    1  &amp; x_2\\
    1  &amp; x_3\\
    . &amp; .\\
    . &amp; .\\
    . &amp; .\\
    1  &amp; x_N\\
\end{bmatrix} \times
`\begin{bmatrix}
    \beta0\\
    \beta1\\ 
\end{bmatrix} +
`\begin{bmatrix}
    \epsilon_1\\
    \epsilon_2\\
    \epsilon_3\\
     .\\
     .\\
     .\\
     \epsilon_N\\
\end{bmatrix}$$`

---
# Under the hood


```r
head(model.matrix(lm(mpg ~ am, data = mtcars)))
```

```
##                   (Intercept) am
## Mazda RX4                   1  1
## Mazda RX4 Wag               1  1
## Datsun 710                  1  1
## Hornet 4 Drive              1  0
## Hornet Sportabout           1  0
## Valiant                     1  0
```

--
### `\(\Large \beta0\)` is the mean mpg for automatic transmissions

--
### `\(\Large \beta1\)` is the *difference* between automatic and manual transmissions

???

This is called the *effects* parameterization

---
# A simple linear model: the t-test


```r
lm(mpg ~ am, data = mtcars)
```



term           estimate   std.error   statistic   p.value
------------  ---------  ----------  ----------  --------
(Intercept)      17.147       1.125      15.248     0e+00
am                7.245       1.764       4.106     3e-04

---
# Under the hood


```r
head(model.matrix(lm(mpg ~ as.factor(am) - 1, data = mtcars)))
```

```
##                   as.factor(am)0 as.factor(am)1
## Mazda RX4                      0              1
## Mazda RX4 Wag                  0              1
## Datsun 710                     0              1
## Hornet 4 Drive                 1              0
## Hornet Sportabout              1              0
## Valiant                        1              0
```

--
### `\(\Large \beta0\)` is the mean mpg for automatic transmissions

--
### `\(\Large \beta1\)` is the mean mpg for manual transmissions

???

This is called the *means* parameterization

---
# A simple linear model: the t-test


```r
lm(mpg ~ as.factor(am) - 1, data = mtcars)
```


term              estimate   std.error   statistic   p.value
---------------  ---------  ----------  ----------  --------
as.factor(am)0       17.15       1.125       15.25         0
as.factor(am)1       24.39       1.360       17.94         0

---
# The t-test becomes an ANOVA


```r
head(model.matrix(lm(mpg ~ as.factor(cyl), data = mtcars)))
```

```
##                   (Intercept) as.factor(cyl)6 as.factor(cyl)8
## Mazda RX4                   1               1               0
## Mazda RX4 Wag               1               1               0
## Datsun 710                  1               0               0
## Hornet 4 Drive              1               1               0
## Hornet Sportabout           1               0               1
## Valiant                     1               1               0
```

--
### `\(\Large \beta0\)` is the mean mpg for 4-cylinders

--
### `\(\Large \beta1\)` is the *difference* between 4-cyl &amp; 6-cyl

--
### `\(\Large \beta2\)` is the *difference* between 4-cyl &amp; 8-cyl


---
# The ANOVA becomes an ANCOVA


```r
head(model.matrix(lm(mpg ~ as.factor(cyl) + hp, data = mtcars)))
```

```
##                   (Intercept) as.factor(cyl)6 as.factor(cyl)8  hp
## Mazda RX4                   1               1               0 110
## Mazda RX4 Wag               1               1               0 110
## Datsun 710                  1               0               0  93
## Hornet 4 Drive              1               1               0 110
## Hornet Sportabout           1               0               1 175
## Valiant                     1               1               0 105
```

--
`\(\large \beta0\)` is the mean mpg for 4-cylinders **@ 0hp**  

--
`\(\large \beta1\)` is the *difference* between 4-cyl &amp; 6-cyl **@ 0hp**  

--
`\(\large \beta2\)` is the *difference* between 4-cyl &amp; 8-cyl **@ 0hp**  

--
`\(\large \beta3\)` is the effect of hp on mpg
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function() {
  var d = document, s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})();</script>

<script>
(function() {
  var i, text, code, codes = document.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
})();
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
